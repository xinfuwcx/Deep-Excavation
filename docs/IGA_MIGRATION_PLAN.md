# 深基坑CAE系统IGA迁移计划

## 背景

深基坑CAE系统最初设计为支持传统有限元法(FEM)和等几何分析(IGA)的混合架构。为了优化系统性能、简化代码库并专注于IGA的优势，本文档概述了从混合架构迁移到纯IGA架构的计划。

## 迁移目标

1. 移除FEM相关代码和依赖，包括Gmsh网格生成组件
2. 简化系统架构，专注于NURBS几何到IGA分析的直接流程
3. 优化性能并降低系统复杂度
4. 减少维护负担并简化用户体验

## 迁移步骤

### 1. 依赖清理

- [x] 从`requirements.minimal.txt`中移除Gmsh依赖
- [ ] 更新`Dockerfile`移除Gmsh相关安装步骤
- [ ] 更新构建脚本，移除Gmsh相关检查

### 2. 代码清理

- [ ] 移除`src/core/meshing/gmsh_wrapper.py`
- [ ] 移除`src/meshing`目录(如果存在)
- [ ] 清理`src/core/simulation`中对网格的引用，改为直接使用NURBS几何

### 3. API路由调整

- [ ] 移除`mesh_router.py`
- [ ] 从`src/api/routes/__init__.py`中移除mesh_router的引用
- [ ] 从`src/server/app.py`中移除mesh_router的引用

### 4. 数据模型调整

- [ ] 修改数据库模型，移除或调整网格相关表
- [ ] 更新数据关系，直接连接几何模型和计算结果

### 5. 前端更新

- [ ] 移除前端中的网格生成页面和组件
- [ ] 更新几何模型直接链接到计算功能
- [ ] 调整用户界面，反映简化的工作流程

## IGA工作流程

迁移后，系统将采用以下工作流程：

```
+---------------+       +-------------------+       +----------------+
| NURBS几何建模  +------>+ Kratos IGA分析    +------>+ 结果可视化     |
+---------------+       +-------------------+       +----------------+
```

### 新工作流程优势

1. **流程简化**：直接从CAD几何到分析，无需网格生成步骤
2. **几何精度**：使用精确NURBS几何，消除网格近似误差
3. **效率提升**：减少数据转换步骤，提高计算效率
4. **用户友好**：简化用户操作流程，减少专业门槛

## 测试计划

1. 设计一组基准测试案例，涵盖多种分析类型
2. 比较迁移前后的结果精度和性能
3. 验证简化流程的稳定性和可靠性

## 风险管理

1. **功能限制**：某些特定分析类型可能在IGA框架下不够成熟，需要权衡替代方案
2. **兼容性**：确保现有项目数据可以平滑迁移到新架构
3. **性能**：监控IGA在某些大规模模型下的性能表现

## 时间线

1. **准备阶段**（1周）：完成迁移计划和测试案例设计
2. **代码清理**（2周）：移除FEM相关代码和依赖
3. **功能验证**（1周）：确保所有IGA功能正常工作
4. **文档更新**（1周）：更新用户手册和API文档
5. **发布版本**：发布纯IGA版本

## 结论

通过转向纯IGA架构，深基坑CAE系统将简化开发和维护流程，同时为用户提供更高效和精确的分析工具。IGA的优势将使系统在处理复杂几何和高精度要求的深基坑分析中脱颖而出。 