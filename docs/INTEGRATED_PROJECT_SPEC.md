# 深基坑CAE系统 - 集成项目规范文档

*本文档整合了深基坑CAE系统的产品规划、核心功能参数、UI设计、交互设计及各工作流的协作规范。作为Claude与Copilot协作的统一参考文档。*

## 1. 项目概述

### 1.1 项目定位
深基坑CAE系统是一款融合了先进CAE分析技术、物理AI和未来科技感UI的工程分析软件，旨在为深基坑工程提供全生命周期的数字化解决方案。

### 1.2 项目架构
系统采用三个并行工作流的开发模式：
- **工作流1**: 物理AI系统 - 由AI团队(Claude)负责
- **工作流2**: 核心CAE功能 - 由分析引擎团队(Claude)负责
- **工作流3**: 前端开发 - 由Copilot团队负责

### 1.3 项目目标
1. 构建一套具有科技感和易用性的深基坑分析系统
2. 融合传统CAE与AI技术，提升分析精度和效率
3. 实现数据驱动的工程决策支持
4. 打造沉浸式工程分析体验

## 2. 核心功能模块

### 2.1 物理AI系统 (工作流1)
当前进度：45%

#### 已完成功能
- PINN核心架构
- 物理约束层
- 弹性问题求解器
- 基本边界条件处理
- IOT数据收集与处理
- 基础FEM-PINN接口

#### 开发中功能
- 复杂边界条件处理
- 多参数同时反演
- 约束条件自适应权重
- GPU训练加速
- 双向实时数据交换

#### 下一步重点
- 完成复杂边界条件处理功能
- 优化参数反演算法
- 完善FEM-PINN双向接口

### 2.2 核心CAE功能 (工作流2)
当前进度：85%

#### 已完成功能
- 基本FEM分析模块
- Netgen网格生成工具集成
- 静力分析功能
- 基本渗流分析功能
- 多土层渗流-结构耦合分析
- 非线性收敛加速技术
- 分步施工模拟与接触分析

#### 开发中功能
- 高级施工序列全流程模拟
- 地下水流动与降水分析
- 大变形问题分析能力
- 复杂土体本构模型扩展

#### 下一步重点
- 开发高级材料模型参数标定工具
- 增强网格生成与自适应细化功能
- 开发分布式计算框架

### 2.3 前端系统 (工作流3)
*由Copilot团队实现的未来科技风UI*

#### 设计风格
- Neomorphism + Glassmorphism 融合
- AI-First 交互模式
- 沉浸式数据可视化
- 量子蓝紫配色方案

#### 主要界面
- 主仪表板("指挥中心")
- 分析页面("实验室")
- 参数设置界面
- 结果可视化界面
- AI助手交互界面

#### 特色组件
- 智能命令面板(AICommandPalette)
- 全息数据球(HolographicDataSphere)
- 预测式工具栏(PredictiveToolbar)
- 悬浮式UI元素
- 流体动画系统

## 3. 参数系统规范

### 3.1 土体材料参数
| 参数名称 | 数据类型 | 单位 | 默认值 | 取值范围 |
|---------|---------|------|-------|---------|
| 密度 | 浮点数 | kg/m³ | 1800 | 1500-2200 |
| 弹性模量 | 浮点数 | kPa | 20000 | 5000-100000 |
| 泊松比 | 浮点数 | - | 0.3 | 0.1-0.49 |
| 内摩擦角 | 浮点数 | ° | 30 | 15-45 |
| 粘聚力 | 浮点数 | kPa | 10 | 0-100 |
| 渗透系数 | 浮点数 | m/day | 0.1 | 1e-6-10 |
| 孔隙比 | 浮点数 | - | 0.5 | 0.3-1.2 |

### 3.2 支护结构参数
| 参数名称 | 数据类型 | 单位 | 默认值 | 取值范围 |
|---------|---------|------|-------|---------|
| 墙体厚度 | 浮点数 | m | 0.8 | 0.3-1.5 |
| 墙体长度 | 浮点数 | m | 20 | 10-60 |
| 墙体弹性模量 | 浮点数 | kPa | 3.0e7 | 1e7-5e7 |
| 支撑刚度 | 浮点数 | kN/m | 1.0e5 | 1e4-1e6 |
| 锚杆预应力 | 浮点数 | kN | 200 | 50-500 |
| 锚杆倾角 | 浮点数 | ° | 15 | 5-30 |

### 3.3 分析控制参数
| 参数名称 | 数据类型 | 单位 | 默认值 | 取值范围 |
|---------|---------|------|-------|---------|
| 计算步数 | 整数 | - | 10 | 1-50 |
| 时间步长 | 浮点数 | day | 1.0 | 0.1-30 |
| 迭代容差 | 浮点数 | - | 1.0e-5 | 1e-8-1e-3 |
| 最大迭代次数 | 整数 | - | 50 | 10-200 |
| 收敛加速策略 | 枚举 | - | "line_search" | ["fixed","aitken","line_search","anderson"] |
| 分析类型 | 枚举 | - | "staged_construction" | ["static","flow","coupled","dynamic"] |

## 4. UI组件设计规范

### 4.1 色彩系统
- **主色调**: 深空蓝紫渐变 (#667eea → #764ba2)
- **次色调**: 玫粉渐变 (#f093fb → #f5576c)
- **强调色**: 青蓝渐变 (#4facfe → #00f2fe)
- **功能色**:
  - 信息: 霓虹蓝 (#00ffff)
  - 警告: 霓虹橙 (#ff6600)
  - 错误: 霓虹粉 (#ff0080)
  - 成功: 霓虹绿 (#39ff14)
- **背景**: 深空渐变 (#0c0c0c → #1a1a2e → #16213e)
- **表面**: 玻璃效果 (rgba(255, 255, 255, 0.05))

### 4.2 常用组件规范

#### 卡片组件
- **背景**: 半透明玻璃效果
- **边框**: 1px微光边框
- **阴影**: 内外双层阴影
- **圆角**: 12px
- **动效**: 悬停时轻微上浮并增加发光效果

#### 按钮组件
- **主按钮**: 渐变背景 + 微光效果
- **次按钮**: 半透明背景 + 细线边框
- **图标按钮**: 霓虹光效图标
- **状态**: 默认、悬停、点击、禁用
- **动效**: 点击波纹 + 轻微形变

#### 输入控件
- **文本输入**: 半透明背景 + 细线底边
- **滑块**: 发光轨道 + 浮动滑块
- **下拉选择**: 玻璃效果菜单 + 过渡动画
- **数值输入**: 数值微调动效 + 单位显示
- **状态**: 聚焦时发光效果

### 4.3 页面布局

#### 主仪表板 ("指挥中心")
```
┌─────────────────────────────────────────────────────────┐
│  🎙️ AI助手     🌐 全息视图     ⚡ 量子计算     👤 用户      │
├─────────────────────────────────────────────────────────┤
│                                                         │
│    ┌─────────────┐  ┌───────────────────────────────┐   │
│    │   快速      │  │                               │   │
│    │   统计      │  │        3D全息数据球            │   │
│    │   卡片      │  │      (旋转、缩放、切片)        │   │
│    │  (霓虹)     │  │                               │   │
│    └─────────────┘  └───────────────────────────────┘   │
│                                                         │
│  ┌─────────────────────────────────────────────────────┐ │
│  │              AI驱动工作流                           │ │
│  │  [几何建模] → [网格生成] → [FEM分析] → [结果可视化]   │ │
│  │     ↑智能推荐    ↑参数优化   ↑实时监控   ↑交互报告   │ │
│  └─────────────────────────────────────────────────────┘ │
│                                                         │
│  ┌───────────────┐  ┌───────────────┐  ┌──────────────┐  │
│  │   最近项目    │  │   AI建议      │  │   实时状态   │  │
│  │  (卡片堆叠)   │  │  (智能提示)   │  │  (脉动效果)  │  │
│  └───────────────┘  └───────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────┘
```

#### 分析页面 ("实验室")
```
┌─────────────────────────────────────────────────────────┐
│  ← 返回   |   深基坑支护结构分析   |   💾 保存   🚀 运行  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ ┌──────────────┐  ┌─────────────────────────────────────┐│
│ │   参数面板   │  │                                     ││
│ │             │  │          3D模型视窗                 ││
│ │ 📊 土体参数  │  │        (实时渲染)                   ││
│ │ 🏗️ 支护结构  │  │                                     ││
│ │ 💧 水位条件  │  │  ┌─────────┐  ┌─────────┐           ││
│ │ ⚡ 分析设置  │  │  │应力云图 │  │位移等值│           ││
│ │             │  │  └─────────┘  └─────────┘           ││
│ │ 🤖 AI优化   │  │                                     ││
│ └──────────────┘  └─────────────────────────────────────┘│
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │              实时计算进度 + AI洞察                   │ │
│ │  ████████████████▒▒▒▒  67%                          │ │
│ │  💡 AI发现: 支护结构在第3层处应力集中，建议加强      │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

## 5. 交互设计规范

### 5.1 基本交互原则
- **预测性交互**: 系统预测用户意图，提前准备相关操作
- **沉浸式体验**: 减少UI干扰，专注于内容和数据
- **多模态输入**: 支持触控、语音、键盘、手势等多种输入方式
- **实时反馈**: 所有操作给予即时可见的反馈
- **流畅过渡**: 状态转换使用流体动画，避免生硬切换

### 5.2 特色交互模式

#### AI命令面板交互
1. 按`Ctrl+Space`或点击麦克风图标唤醒
2. 输入/说出自然语言命令(如"分析基坑稳定性")
3. AI实时提取参数和意图，显示理解结果
4. 用户确认或修正理解
5. 执行操作并显示进度反馈

#### 3D模型交互
1. **旋转**: 拖拽或两指旋转手势
2. **缩放**: 滚轮或捏合手势
3. **平移**: 右键拖拽或三指拖拽
4. **截面**: Alt+拖拽创建截面
5. **标注**: Shift+点击添加标注点
6. **查询**: 直接点击查询结果数据

#### 参数面板交互
1. **分组展开/折叠**: 点击组标题
2. **参数调整**: 滑块/数值输入
3. **智能建议**: AI建议最优参数(蓝色高亮)
4. **参数联动**: 相关参数自动联动调整
5. **历史记录**: 显示参数变更历史

### 5.3 弹窗和通知系统

#### 对话框类型
1. **确认对话框**: 需用户确认的重要操作
2. **信息对话框**: 展示详细信息
3. **警告对话框**: 操作可能有风险
4. **错误对话框**: 操作失败或系统错误
5. **进度对话框**: 显示长时间操作进度

#### 通知类型
1. **成功通知**: 右上角、绿色、3秒后自动消失
2. **信息通知**: 右上角、蓝色、5秒后自动消失
3. **警告通知**: 右上角、橙色、需点击关闭
4. **错误通知**: 右上角、红色、需点击关闭
5. **进度通知**: 右上角、带进度条、操作完成后转为结果通知

## 6. 工作流协作规范

### 6.1 工作流间API接口

#### 工作流1 (物理AI) 提供的API
- `/api/ai/param-inversion` - 参数反演API
- `/api/ai/prediction` - AI预测API
- `/api/ai/model-status` - AI模型状态API
- `/api/ai/iot-data` - IOT数据访问API

#### 工作流2 (核心CAE) 提供的API
- `/api/compute/mesh` - 网格生成与管理API
- `/api/compute/mesh/import-netgen` - Netgen网格导入API
- `/api/compute/analysis` - 分析计算API
- `/api/compute/results` - 结果获取API
- `/api/compute/materials` - 材料模型API

### 6.2 数据交换格式
- 几何和网格数据: VTK/JSON格式
- 分析参数: JSON格式
- 分析结果: HDF5/VTK格式
- 监测数据: CSV/JSON格式

### 6.3 协作流程

#### 新功能开发流程
1. 确定功能需求和规范
2. 工作流1/2团队实现后端功能
3. 制定前端交互设计规范
4. 工作流3团队实现前端界面
5. 集成测试与优化

#### Bug修复流程
1. 前端报告bug并提供复现步骤
2. 相关工作流团队确认并修复
3. 修复后进行集成测试
4. 发布更新

## 7. 实施计划

### 7.1 短期目标 (1-3个月)
1. 完成Netgen网格导入功能的前后端实现
2. 实现智能命令面板(AICommandPalette)核心功能
3. 完善渗流-结构耦合分析的用户交互
4. 优化3D模型操作体验

### 7.2 中期目标 (3-6个月)
1. 实现全息数据球(HolographicDataSphere)可视化组件
2. 完成AI参数反演与优化的前端交互
3. 实现分步施工模拟的动态可视化
4. 开发预测式工具栏(PredictiveToolbar)

### 7.3 长期目标 (6-12个月)
1. 完整实现未来科技风UI系统
2. 集成完整的AI助手交互系统
3. 实现沉浸式数据可视化体验
4. 建立统一的多模态交互框架

## 8. 协作要点

### 工作流1和工作流2 (Claude负责)
- 确保API稳定性和性能
- 提供详细的接口文档
- 参与前端设计规范讨论
- 提供真实测试数据

### 工作流3 (Copilot负责)
- 遵循未来科技风UI设计规范
- 实现响应式、高性能的前端界面
- 确保多设备兼容性
- 优化用户交互体验

---

*此文档由Claude和Copilot共同维护，作为项目协作的统一参考。* 